(this.webpackJsonpperview=this.webpackJsonpperview||[]).push([[0],{31:function(e,t,n){e.exports=n(40)},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(5),o=n.n(r),a=n(28),i=n.n(a),c=(n(38),n(30)),u=n(47),s=n(49),l=n(45),p=n(0),m=n(1),d=n(2),f=n(3),g=function(e){Object(f.a)(Attack,e);var t=Object(d.a)(Attack);function Attack(){var e;Object(p.a)(this,Attack);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).projectileColor="#000000",e.projectileSpeed=0,e.projectileLifetime=0,e.projectileDamage=0,e.minimumRefactoryPeriod=0,e.lastAttack=0,e}return Attack}(m.a);g.schema={projectileColor:{type:m.d.String},projectileSpeed:{type:m.d.Number},projectileLifetime:{type:m.d.Number},projectileDamage:{type:m.d.Number},minimumRefactoryPeriod:{type:m.d.Number},lastAttack:{type:m.d.Number}};var h=g,v=function(e){Object(f.a)(Circle,e);var t=Object(d.a)(Circle);function Circle(){var e;Object(p.a)(this,Circle);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).color="#000000",e.radius=0,e}return Circle}(m.a);v.schema={color:{type:m.d.String},radius:{type:m.d.Number}};var b=v,y=function(e){Object(f.a)(Collidable,e);var t=Object(d.a)(Collidable);function Collidable(){return Object(p.a)(this,Collidable),t.apply(this,arguments)}return Collidable}(m.c),C=function(e){Object(f.a)(Debug,e);var t=Object(d.a)(Debug);function Debug(){return Object(p.a)(this,Debug),t.apply(this,arguments)}return Debug}(m.c),S=function Vector2(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(p.a)(this,Vector2),this.x=void 0,this.y=void 0,this.set=function(t,n){return e.x=t,e.y=n,e},this.copy=function(t){return e.x=t.x,e.y=t.y,e},this.clone=function(){return(new Vector2).copy(e)},this.add=function(t){return e.clone().addMut(t)},this.addMut=function(t){return e.x+=t.x,e.y+=t.y,e},this.angleTo=function(t){var n=e.x,r=e.y,o=n*t.x+r*t.y,a=e.magnitude()*t.magnitude();return Math.acos(o/a)},this.limit=function(t){return e.clone().limitMut(t)},this.limitMut=function(t){var n=e.magnitude();return t<n&&e.divideScalarMut(n/t),e},this.divideScalar=function(t){return e.clone().divideScalarMut(t)},this.divideScalarMut=function(t){return e.x/=t,e.y/=t,e},this.magnitude=function(){return Math.sqrt(e.x*e.x+e.y*e.y)},this.multiplyScalar=function(t){return e.clone().multiplyScalarMut(t)},this.multiplyScalarMut=function(t){return e.x*=t,e.y*=t,e},this.toJSON=function(t){var n=e.x,r=e.y;return JSON.stringify({x:n,y:r},null,null!==t&&void 0!==t?t:0)},this.subtract=function(t){return e.clone().subtractMut(t)},this.subtractMut=function(t){return e.x-=t.x,e.y-=t.y,e},this.unit=function(){return e.clone().unitMut()},this.unitMut=function(){var t=e.magnitude();return 0===t?e.multiplyScalar(0):e.divideScalarMut(t)},this.x=t,this.y=n},j=S,O=Object(m.h)({name:"Vector2",default:new S,copy:m.g,clone:m.f}),M=function(e){Object(f.a)(DebugVector,e);var t=Object(d.a)(DebugVector);function DebugVector(){var e;Object(p.a)(this,DebugVector);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).position=new j,e.direction=new j,e.color="#ff00ff",e}return DebugVector}(m.a);M.schema={position:{type:O},direction:{type:O},color:{type:m.d.String}};var w=M,D=function(e){Object(f.a)(Destination,e);var t=Object(d.a)(Destination);function Destination(){var e;Object(p.a)(this,Destination);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).position=new j,e}return Destination}(m.a);D.schema={position:{type:O}};var x=D,k=function(e){Object(f.a)(DestroyedOnImpact,e);var t=Object(d.a)(DestroyedOnImpact);function DestroyedOnImpact(){return Object(p.a)(this,DestroyedOnImpact),t.apply(this,arguments)}return DestroyedOnImpact}(m.c),E=function(e){Object(f.a)(DoesDamage,e);var t=Object(d.a)(DoesDamage);function DoesDamage(){var e;Object(p.a)(this,DoesDamage);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).damage=0,e}return DoesDamage}(m.a);E.schema={damage:{type:m.d.Number}};var q=E,A=function(e){Object(f.a)(Health,e);var t=Object(d.a)(Health);function Health(){var e;Object(p.a)(this,Health);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).maxHealth=0,e.health=0,e}return Health}(m.a);A.schema={maxHealth:{type:m.d.Number},health:{type:m.d.Number}};var P=A,R=function(e){Object(f.a)(Lifespan,e);var t=Object(d.a)(Lifespan);function Lifespan(){var e;Object(p.a)(this,Lifespan);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).ttl=0,e.createdAt=0,e}return Lifespan}(m.a);R.schema={ttl:{type:m.d.Number},createdAt:{type:m.d.Number}};var V=R,N=function(e){Object(f.a)(Moveable,e);var t=Object(d.a)(Moveable);function Moveable(){var e;Object(p.a)(this,Moveable);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).direction=new j,e.maxSpeed=0,e.minSeparation=0,e.separation=0,e}return Moveable}(m.a);N.schema={direction:{type:O},maxSpeed:{type:m.d.Number},minSeparation:{type:m.d.Number},separation:{type:m.d.Number}};var T=N,H=function(e){Object(f.a)(Position,e);var t=Object(d.a)(Position);function Position(){var e;Object(p.a)(this,Position);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).position=new j,e}return Position}(m.a);H.schema={position:{type:O}};var F=H,L=function(e){Object(f.a)(RectangleSelection,e);var t=Object(d.a)(RectangleSelection);function RectangleSelection(){var e;Object(p.a)(this,RectangleSelection);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).startPosition=new j,e.endPosition=new j,e}return RectangleSelection}(m.a);L.schema={startPosition:{type:O},endPosition:{type:O}};var W=L,I=function(e){Object(f.a)(Selectable,e);var t=Object(d.a)(Selectable);function Selectable(){var e;Object(p.a)(this,Selectable);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).selected=!1,e}return Selectable}(m.a);I.schema={selected:{type:m.d.Boolean}};var U=I,z=function(e){Object(f.a)(Team,e);var t=Object(d.a)(Team);function Team(){var e;Object(p.a)(this,Team);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).name="unknown",e}return Team}(m.a);z.schema={name:{type:m.d.String}};var B=z,K=n(4),Z=n(42),J=n(46),X=n(50),Y=n(43),G=function(e){Object(f.a)(Attacker,e);var t=Object(d.a)(Attacker);function Attacker(){var e;Object(p.a)(this,Attacker);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).closestUnObstructedTarget=function(t){var n=t.getComponent(F).position,r=t.getComponent(B),o=e.queries.targets.results.filter((function(e){return r.name!==e.getComponent(B).name})),a=e.getTeammates(t),i=o.filter((function(n){return e.inRange(t,n)})).filter((function(n){return!e.isObstructed(t,n,a)}));return Z.a((function(e){return e.getComponent(F).position.subtract(n).magnitude()}),i)[0]},e.inRange=function(e,t){var n=e.getComponent(F).position,r=t.getComponent(F).position,o=e.getComponent(h),a=o.projectileSpeed*o.projectileLifetime/1e3;return r.subtract(n).magnitude()<=a},e.isObstructed=function(t,n,r){var o=J.a([t],r);return X.a(e.inTheWayOfTarget(t)(n),o)},e.inTheWayOfTarget=Y.a((function(e,t,n){var r=e.getComponent(F).position,o=t.getComponent(F).position,a=n.getComponent(F).position,i=n.getComponent(b).radius,c=o.subtract(r),u=a.subtract(o),s=c.angleTo(u);return!(c.magnitude()<u.magnitude())&&(!(s>Math.PI/2)&&Math.sin(s)*u.magnitude()<i)})),e.attackTarget=function(t,n,r){var o=n.getMutableComponent(h);o.lastAttack=t;var a=n.getComponent(b).radius,i=n.getComponent(F).position,c=r.getComponent(F).position.subtract(i).unitMut().multiplyScalarMut(o.projectileSpeed),u=c.unit().multiplyScalarMut(a+3).addMut(i);e.world.createEntity().addComponent(b,{color:o.projectileColor,radius:2}).addComponent(q,{damage:o.projectileDamage}).addComponent(k).addComponent(T,{maxSpeed:o.projectileSpeed,direction:c}).addComponent(F,{position:u}).addComponent(V,{createdAt:t,ttl:o.projectileLifetime})},e.getTeammates=function(t){var n=t.getComponent(B).name;return J.a([t],e.queries.attackers.results).filter((function(e){return n===e.getComponent(B).name}))},e}return Object(K.a)(Attacker,[{key:"execute",value:function execute(e,t){var n=this;this.queries.attackers.results.forEach((function(e){var r=e.getComponent(h);if(!(t<r.lastAttack+r.minimumRefactoryPeriod)){var o=n.closestUnObstructedTarget(e);o&&n.attackTarget(t,e,o)}}))}}]),Attacker}(m.b);G.queries={attackers:{components:[h,b,F,B]},targets:{components:[F,B,b]}};var $=G,Q=n(51),_=n(48),ee=function(e){Object(f.a)(Boidser,e);var t=Object(d.a)(Boidser);function Boidser(){var e;Object(p.a)(this,Boidser);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).executeEntity=function(t){var n=t.getComponent(F).position,r=t.getMutableComponent(T),o=r.direction,a=r.maxSpeed,i=e.getTeammates(t),c=e.calcDestinationForce(t),u=e.calcSeparationForce(50,t,i),s=e.calcCohesionForce(t,i),l=e.calcAlignmentForce(t,i);if(o.set(0,0).addMut(c).addMut(u).addMut(s.divideScalarMut(1e3)).addMut(l.multiplyScalarMut(10)).limitMut(a),e.world.createEntity().addComponent(w,{color:"rgba(255, 0, 0, 0.5)",position:n,direction:o}),Number.isNaN(o.x)||Number.isNaN(o.y))throw new Error("divided.x was NaN")},e.calcAlignmentForce=function(e,t){var n=new j(0,0),r=e.getComponent(F).position;return t.forEach((function(e){var t=e.getComponent(F).position,o=e.getComponent(T).direction,a=r.subtract(t).magnitude(),i=o.divideScalar(a);n.addMut(i)})),Q.a(t)?n:n.divideScalarMut(t.length)},e.calcAveragePosition=function(e){var t=e.map((function(e){return e.getComponent(F).position})),n=new j(0,0);return t.forEach(n.addMut),Q.a(t)?n:n.divideScalarMut(t.length)},e.calcCohesionForce=function(t,n){var r=t.getComponent(F).position;return e.calcAveragePosition(n).subtractMut(r)},e.calcDestinationForce=function(e){if(!e.hasComponent(x))return new j(0,0);var t=e.getComponent(x).position,n=e.getComponent(F).position;return t.subtract(n)},e.calcSeparationForce=function(t,n,r){var o=new j(0,0),a=_.a(e.calcSingleSeparationForce(t)(n),r),i=n.getComponent(F).position;return a.forEach((function(t){e.world.createEntity().addComponent(w,{color:"rgba(0, 255, 0, 0.05)",position:i,direction:t})})),a.forEach(o.addMut),Q.a(a)?o:o.divideScalar(a.length)},e.calcSingleSeparationForce=Y.a((function(e,t,n){var r=t.getComponent(F).position,o=n.getComponent(F).position,a=t.getComponent(T),i=a.minSeparation,c=a.separation,u=r.subtract(o),s=o.subtract(r).limitMut(i).addMut(r).subtractMut(o).magnitude(),l=u.magnitude();return c<s?u.multiplyScalarMut(0):0===s||l<i?u.multiplyScalarMut(Math.pow(10,10)):u.divideScalarMut(s).multiplyScalarMut(e)})),e.getTeammates=function(t){var n=t.getComponent(B).name;return J.a([t],e.queries.entities.results).filter((function(e){return n===e.getComponent(B).name}))},e}return Object(K.a)(Boidser,[{key:"execute",value:function execute(e,t){this.queries.entities.results.forEach(this.executeEntity)}}]),Boidser}(m.b);ee.queries={entities:{components:[T,F,B]}};var te=ee,ne=function(e){Object(f.a)(Camera,e);var t=Object(d.a)(Camera);function Camera(){var e;Object(p.a)(this,Camera);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).panSpeed=0,e.zoomSpeed=0,e.zoom=0,e}return Camera}(m.a);ne.schema={panSpeed:{type:m.d.Number},zoom:{type:m.d.Number},zoomSpeed:{type:m.d.Number}};var re=ne,oe=function(e){Object(f.a)(DestinationSetter,e);var t=Object(d.a)(DestinationSetter);function DestinationSetter(){var e;Object(p.a)(this,DestinationSetter);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onMouseDown=function(t){if(2===t.button){var n=t.clientX,r=t.clientY;e.selected().forEach((function(t){t.hasComponent(x)||t.addComponent(x),t.getMutableComponent(x).position.set(n,r).subtractMut(e.cameraOffset())}))}},e.selected=function(){return e.queries.selectables.results.filter((function(e){return e.getComponent(U).selected}))},e.cameraOffset=function(){return e.queries.cameras.results[0].getComponent(F).position},e}return Object(K.a)(DestinationSetter,[{key:"execute",value:function execute(e,t){}}]),DestinationSetter}(m.b);oe.queries={cameras:{components:[re,F]},selectables:{components:[T,U]}};var ae=oe,ie=function(e){Object(f.a)(EnforceHealth,e);var t=Object(d.a)(EnforceHealth);function EnforceHealth(){return Object(p.a)(this,EnforceHealth),t.apply(this,arguments)}return Object(K.a)(EnforceHealth,[{key:"execute",value:function execute(e,t){this.queries.withHealth.results.forEach((function(e){e.getComponent(P).health<=0&&e.remove()}))}}]),EnforceHealth}(m.b);ie.queries={withHealth:{components:[P]}};var ce=ie,ue=function(e){Object(f.a)(EnforceLifespan,e);var t=Object(d.a)(EnforceLifespan);function EnforceLifespan(){return Object(p.a)(this,EnforceLifespan),t.apply(this,arguments)}return Object(K.a)(EnforceLifespan,[{key:"execute",value:function execute(e,t){this.queries.withLifepan.results.forEach((function(e){var n=e.getComponent(V),r=n.ttl;n.createdAt+r<t&&e.remove()}))}}]),EnforceLifespan}(m.b);ue.queries={withLifepan:{components:[V]}};var se=ue,le=function(e){Object(f.a)(Mover,e);var t=Object(d.a)(Mover);function Mover(){return Object(p.a)(this,Mover),t.apply(this,arguments)}return Object(K.a)(Mover,[{key:"execute",value:function execute(e,t){this.queries.moveables.results.forEach((function(t){var n=t.getMutableComponent(F).position,r=t.getComponent(T).direction,o=r.x*(e/1e3),a=r.y*(e/1e3);n.x+=o,n.y+=a}))}}]),Mover}(m.b);le.queries={moveables:{components:[T,F]}};var pe=le,me=function distanceBetween(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},de=function positionsAreClose(e,t,n){return me(e,t)<=n},fe=function(e){Object(f.a)(RectangleSelector,e);var t=Object(d.a)(RectangleSelector);function RectangleSelector(){var e;Object(p.a)(this,RectangleSelector);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onMouseDown=function(t){if(0===t.button&&!(e.queries.rectangleSelections.results.length>0)){var n=new j(t.clientX,t.clientY).divideScalarMut(e.cameraScale()).subtractMut(e.cameraOffset()),r=n.clone();e.world.createEntity().addComponent(W,{startPosition:n,endPosition:r})}},e.onMouseMove=function(t){var n=t.clientX,r=t.clientY;e.queries.rectangleSelections.results.forEach((function(t){var o=t.getComponent(W).endPosition;n!==o.x&&r!==o.y&&t.getMutableComponent(W).endPosition.set(n,r).divideScalarMut(e.cameraScale()).subtractMut(e.cameraOffset())}))},e.onMouseUp=function(t){0===t.button&&e.queries.rectangleSelections.results.forEach((function(t){var n=t.getComponent(W),r=n.startPosition,o=n.endPosition;t.remove(),de(r,o,5)||e.queries.selectables.results.forEach((function(e){var t=e.getMutableComponent(U),n=e.getComponent(F).position,a=n.x,i=n.y,c=r.x<a&&a<o.x||o.x<a&&a<r.x,u=r.y<i&&i<o.y||o.y<i&&i<r.y;t.selected=c&&u}))}))},e.cameraOffset=function(){return e.queries.cameras.results[0].getComponent(F).position},e.cameraScale=function(){return e.queries.cameras.results[0].getComponent(re).zoom},e}return Object(K.a)(RectangleSelector,[{key:"execute",value:function execute(e,t){}}]),RectangleSelector}(m.b);fe.queries={cameras:{components:[re,F]},selectables:{components:[F,U]},rectangleSelections:{components:[W]}};var ge=fe,he=function(e){Object(f.a)(VectorDebugState,e);var t=Object(d.a)(VectorDebugState);function VectorDebugState(){var e;Object(p.a)(this,VectorDebugState);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).enabled=!1,e}return VectorDebugState}(m.a);he.schema={enabled:{type:m.d.Boolean}};var ve=he,be=function(e){Object(f.a)(Renderer,e);var t=Object(d.a)(Renderer);function Renderer(e,n){var r,o=n.canvas,a=n.colors,i=n.priority;return Object(p.a)(this,Renderer),(r=t.call(this,e,{priority:i})).canvas=void 0,r.colors=void 0,r.ctx=void 0,r.renderCircles=function(){return r.queries.circles.results.forEach(r.renderCircle)},r.renderHealths=function(){return r.queries.healths.results.forEach(r.renderHealth)},r.renderRectangleSelections=function(){return r.queries.rectangleSelections.results.forEach(r.renderRectangleSelection)},r.cameraOffset=function(){return r.queries.cameras.results[0].getComponent(F).position},r.cameraScale=function(){return r.queries.cameras.results[0].getComponent(re).zoom},r.clear=function(){r.ctx&&(r.ctx.fillStyle=r.colors.background,r.ctx.fillRect(0,0,r.canvas.width,r.canvas.height))},r.renderCircle=function(e){var t,n;if(r.ctx){var o=r.cameraOffset(),a=r.cameraScale(),i=r.ctx,c=e.getComponent(b),u=c.color,s=c.radius,l=e.getComponent(F).position,p=null!==(t=null===(n=e.getComponent(U))||void 0===n?void 0:n.selected)&&void 0!==t&&t,m=l.add(o).multiplyScalar(a),d=m.x,f=m.y,g=s*a,h=(s+2)*a;i.fillStyle=u,i.beginPath(),i.arc(d,f,g,0,2*Math.PI,!1),i.fill(),i.lineWidth=2*a,i.strokeStyle="#222",i.stroke(),p&&(i.beginPath(),i.arc(d,f,h,0,2*Math.PI,!1),i.lineWidth=2*a,i.strokeStyle=r.colors.selection,i.stroke())}},r.renderDebugVector=function(e){return r.renderVector(e.getComponent(w))},r.renderHealth=function(e){var t=r.ctx;if(t){var n=r.cameraOffset(),o=r.cameraScale(),a=e.getComponent(F).position,i=e.getComponent(P),c=i.health,u=i.maxHealth,s=a.add(new j(-10,15)).addMut(n).multiplyScalarMut(o),l=s.x,p=s.y,m=20*o,d=4*o,f=m*c/u;t.lineWidth=2*o,t.strokeStyle="#222",t.strokeRect(l,p,m,d),t.lineWidth=0,t.fillStyle=r.colors.selection,t.fillRect(l,p,f,d)}},r.renderRectangleSelection=function(e){if(r.ctx){var t=r.cameraOffset(),n=r.cameraScale(),o=r.ctx,a=e.getComponent(W);if(!de(a.startPosition,a.endPosition,5)){var i=a.startPosition.add(t).multiplyScalarMut(n),c=a.endPosition.add(t).multiplyScalarMut(n),u=i.x,s=i.y,l=c.x-u,p=c.y-s;o.lineWidth=2*n,o.strokeStyle=r.colors.selection,o.strokeRect(u,s,l,p)}}},r.renderVector=function(e){var t=e.position,n=e.direction,o=e.color;if(r.ctx){var a=t.add(r.cameraOffset()),i=a.add(n),c=i.x,u=i.y,s=r.ctx;s.lineWidth=2,s.strokeStyle=o,s.beginPath(),s.moveTo(a.x,a.y),s.lineTo(c,u),s.stroke()}},r.vectorDebugEnabled=function(){var e;return null===(e=r.queries.vectorDebugStates.results[0])||void 0===e?void 0:e.getComponent(ve).enabled},r.canvas=o,r.colors=a,r.ctx=r.canvas.getContext("2d"),r}return Object(K.a)(Renderer,[{key:"execute",value:function execute(e,t){this.clear(),this.renderCircles(),this.renderHealths(),this.renderRectangleSelections(),this.renderDebugVectors()}},{key:"renderDebugVectors",value:function renderDebugVectors(){this.vectorDebugEnabled()&&this.queries.debugVectors.results.forEach(this.renderDebugVector),this.queries.debugVectors.results.forEach((function(e){return e.remove()}))}}]),Renderer}(m.b);be.queries={cameras:{components:[re,F]},circles:{components:[b,F]},debugVectors:{components:[w]},healths:{components:[P,F]},rectangleSelections:{components:[W]},vectorDebugStates:{components:[ve]}};var ye=be,Ce=function(e){Object(f.a)(Selector,e);var t=Object(d.a)(Selector);function Selector(){var e;Object(p.a)(this,Selector);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onMouseDown=function(t){if(0===t.button){var n=new j(t.clientX,t.clientY).divideScalarMut(e.cameraScale()).subtractMut(e.cameraOffset());e.selectCircles(n)}},e.selectCircles=function(t){e.deselectAllCircles(),e.queries.circles.results.forEach((function(e){var n=e.getComponent(b).radius,r=e.getComponent(F).position;de(t,r,n)&&(e.getMutableComponent(U).selected=!0)}))},e.deselectAllCircles=function(){e.queries.circles.results.forEach((function(e){e.getComponent(U).selected&&(e.getMutableComponent(U).selected=!1)}))},e.cameraOffset=function(){return e.queries.cameras.results[0].getComponent(F).position},e.cameraScale=function(){return e.queries.cameras.results[0].getComponent(re).zoom},e}return Object(K.a)(Selector,[{key:"execute",value:function execute(e,t){}}]),Selector}(m.b);Ce.queries={cameras:{components:[re,F]},circles:{components:[b,F,U]}};var Se=Ce,je=n(52),Oe=n(44),Me=Y.a((function(e,t){if(e===t)return!1;var n=e.getComponent(b),r=e.getComponent(F),o=t.getComponent(b),a=t.getComponent(F),i=n.radius+o.radius;return de(r.position,a.position,i)})),we=function(e){Object(f.a)(Stopper,e);var t=Object(d.a)(Stopper);function Stopper(){var e;Object(p.a)(this,Stopper);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).stopIfAtDestination=function(e){var t=e.getComponent(F).position,n=e.getComponent(x).position;de(t,n,1)&&(e.getMutableComponent(T).direction.set(0,0),e.removeComponent(x))},e.stopIfColliding=function(t){var n=je.a(Me(t),e.queries.collideables.results);if(!Oe.a(n)){if(t.getMutableComponent(T).direction.set(0,0),t.hasComponent(q)&&n.hasComponent(P)){var r=t.getComponent(q).damage;n.getMutableComponent(P).health-=r}t.hasComponent(k)&&t.remove()}},e}return Object(K.a)(Stopper,[{key:"execute",value:function execute(e,t){this.queries.moveables.results.forEach(this.stopIfColliding),this.queries.withDestination.results.forEach(this.stopIfAtDestination)}}]),Stopper}(m.b);we.queries={collideables:{components:[b,y,F]},moveables:{components:[b,T,F]},withDestination:{components:[x,T,F]}};var De=we,xe=function(e){Object(f.a)(VectorDebugger,e);var t=Object(d.a)(VectorDebugger);function VectorDebugger(){var e;Object(p.a)(this,VectorDebugger);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onKeyDown=function(t){if("v"===t.key){var n=e.queries.vectorDebugStates.results[0].getMutableComponent(ve);n.enabled=!n.enabled}},e}return Object(K.a)(VectorDebugger,[{key:"execute",value:function execute(e,t){}}]),VectorDebugger}(m.b);xe.queries={vectorDebugStates:{components:[ve]}};var ke=xe,Ee=function(e){Object(f.a)(CameraPanner,e);var t=Object(d.a)(CameraPanner);function CameraPanner(){var e;Object(p.a)(this,CameraPanner);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).panning={up:!1,right:!1,down:!1,left:!1},e.onKeyDown=function(t){"w"===t.key&&(e.panning.up=!0),"d"===t.key&&(e.panning.right=!0),"s"===t.key&&(e.panning.down=!0),"a"===t.key&&(e.panning.left=!0)},e.onKeyUp=function(t){"w"===t.key&&(e.panning.up=!1),"d"===t.key&&(e.panning.right=!1),"s"===t.key&&(e.panning.down=!1),"a"===t.key&&(e.panning.left=!1)},e}return Object(K.a)(CameraPanner,[{key:"execute",value:function execute(e,t){var n=this.queries.cameras.results[0],r=n.getMutableComponent(re).panSpeed,o=n.getMutableComponent(F).position,a=new j((this.panning.left?1:0)+(this.panning.right?-1:0),(this.panning.up?1:0)+(this.panning.down?-1:0)).multiplyScalarMut(r*e/1e3);o.addMut(a)}}]),CameraPanner}(m.b);Ee.queries={cameras:{components:[re,F]}};var qe=Ee,Ae=function(e){Object(f.a)(CameraZoomer,e);var t=Object(d.a)(CameraZoomer);function CameraZoomer(){var e;Object(p.a)(this,CameraZoomer);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onMouseWheel=function(t){var n=e.queries.cameras.results[0].getMutableComponent(re),r=-1*t*n.zoomSpeed;n.zoom=r<=0?1e-9:r},e}return Object(K.a)(CameraZoomer,[{key:"execute",value:function execute(e,t){}}]),CameraZoomer}(m.b);Ae.queries={cameras:{components:[re]}};var Pe=Ae,Re={friendly:"#59cd90",enemy:"#c73e1d",projectile:"#ffe74c",background:"#545e75",selection:"#57b8ff"},Ve=function Game(e){var t=this,n=e.canvas;Object(p.a)(this,Game),this.world=void 0,this.lastTime=void 0,this.animationFrameRequest=void 0,this.start=function(){t.createCamera(),t.createVectorDebugState();for(var e=0;e<10;e++)t.createFriendly(50+50*e,500),t.createEnemy(50+50*e,100);t.run()},this.stop=function(){t.animationFrameRequest&&cancelAnimationFrame(t.animationFrameRequest)},this.onKeyDown=function(e){t.vectorDebugger().onKeyDown(e),t.cameraPanner().onKeyDown(e)},this.onKeyUp=function(e){t.cameraPanner().onKeyUp(e)},this.onMouseDown=function(e){t.destinationSetter().onMouseDown(e),t.selector().onMouseDown(e),t.rectangleSelector().onMouseDown(e)},this.onMouseMove=function(e){return t.rectangleSelector().onMouseMove(e)},this.onMouseUp=function(e){return t.rectangleSelector().onMouseUp(e)},this.onMouseWheel=function(e){return t.cameraZoomer().onMouseWheel(e)},this.createCamera=function(){t.world.createEntity().addComponent(re,{panSpeed:500,zoomSpeed:.1,zoom:1}).addComponent(F,{position:new j(0,0)})},this.createEnemy=function(e,n){var r=Re.enemy,o=new j(e,n),a=Re.projectile;t.world.createEntity().addComponent(h,{projectileColor:a,projectileSpeed:200,projectileLifetime:1800,projectileDamage:10,minimumRefactoryPeriod:500}).addComponent(b,{radius:10,color:r}).addComponent(y).addComponent(P,{health:100,maxHealth:100}).addComponent(F,{position:o}).addComponent(B,{name:"Enemy"})},this.createFriendly=function(e,n){var r=Re.friendly,o=new j,a=new j(e,n),i=Re.projectile;t.world.createEntity().addComponent(h,{projectileColor:i,projectileSpeed:200,projectileLifetime:1800,projectileDamage:10,minimumRefactoryPeriod:500}).addComponent(b,{radius:10,color:r}).addComponent(y).addComponent(P,{health:100,maxHealth:100}).addComponent(T,{direction:o,maxSpeed:100,separation:30,minSeparation:20}).addComponent(F,{position:a}).addComponent(U).addComponent(B,{name:"Friendly"})},this.createVectorDebugState=function(){t.world.createEntity().addComponent(ve)},this.run=function(){var e=performance.now(),n=e-t.lastTime;t.world.execute(n,e),t.lastTime=e,t.animationFrameRequest=requestAnimationFrame(t.run)},this.cameraPanner=function(){return t.world.getSystem(qe)},this.cameraZoomer=function(){return t.world.getSystem(Pe)},this.destinationSetter=function(){return t.world.getSystem(ae)},this.rectangleSelector=function(){return t.world.getSystem(ge)},this.renderer=function(){return t.world.getSystem(ye)},this.selector=function(){return t.world.getSystem(Se)},this.vectorDebugger=function(){return t.world.getSystem(ke)},this.lastTime=performance.now(),this.animationFrameRequest=null,this.world=(new m.e).registerSystem($).registerSystem(te).registerSystem(qe).registerSystem(Pe).registerSystem(ae).registerSystem(se).registerSystem(ce).registerSystem(pe).registerSystem(ge).registerSystem(ye,{canvas:n,colors:Re}).registerSystem(Se).registerSystem(De).registerSystem(ke).registerComponent(h).registerComponent(re).registerComponent(b).registerComponent(y).registerComponent(C).registerComponent(w).registerComponent(x).registerComponent(k).registerComponent(q).registerComponent(P).registerComponent(V).registerComponent(T).registerComponent(F).registerComponent(W).registerComponent(U).registerComponent(B).registerComponent(ve)},Ne=(n(39),function App(){var e=o.a.useState(null),t=Object(c.a)(e,2),n=t[0],r=t[1],a=o.a.useRef(null);o.a.useEffect((function(){if(n)return a.current=new Ve({canvas:n}),a.current.start(),function(){var e;null===(e=a.current)||void 0===e||e.stop(),a.current=null}}),[n]);var i=Object(u.a)(),p=i.width,m=i.height;n&&(n.width=p,n.height=m);Object(s.a)((function(){return!0}),(function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.onKeyDown(e)}),{event:"keydown"}),Object(s.a)((function(){return!0}),(function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.onKeyUp(e)}),{event:"keyup"});var d=Object(l.a)();return o.a.useEffect((function(){var e;return null===(e=a.current)||void 0===e?void 0:e.onMouseWheel(d)}),[d]),o.a.createElement("div",{className:"App"},o.a.createElement("canvas",{ref:r,onMouseDown:function onMouseDown(e){var t;e.preventDefault(),e.stopPropagation(),null===(t=a.current)||void 0===t||t.onMouseDown(e)},onMouseMove:function onMouseMove(e){var t;return null===(t=a.current)||void 0===t?void 0:t.onMouseMove(e)},onMouseUp:function onMouseUp(e){var t;return null===(t=a.current)||void 0===t?void 0:t.onMouseUp(e)},onContextMenu:function onContextMenu(e){return e.preventDefault()}}))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Ne,null)),document.getElementById("root")),function unregister(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}()}},[[31,1,2]]]);
//# sourceMappingURL=main.471e023b.chunk.js.map